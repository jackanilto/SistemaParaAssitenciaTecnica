unit UClasse.Entity.Table;

interface

uses
  UInterfaces, FireDAC.Comp.Client, UDados.Conexao, Vcl.StdCtrls;

type

  TEntityTable = class(TInterfacedObject, iFDTable)
  private
    F_Table: TFDTable;
  public
    function FD_Table(value: string): iFDTable;
    function popularComponenteComboBox(value: TcomboBox): iFDTable;
    constructor create;
    destructor destroy; override;
    class function new: iFDTable;
  end;

implementation

{ TEntityTable }

constructor TEntityTable.create;
begin
  F_Table := TFDTable.create(nil);
  F_Table.Connection := DataModule1.Conexao;
end;

destructor TEntityTable.destroy;
begin
  F_Table.Free;
  inherited;
end;

function TEntityTable.FD_Table(value: string): iFDTable;
begin
  F_Table.TableName := value;
  F_Table.Active := true;
  result := self;
end;

class function TEntityTable.new: iFDTable;
begin
  result := self.create;
end;

function TEntityTable.popularComponenteComboBox(value: TcomboBox): iFDTable;
begin
  while not F_Table.Eof do
  begin
    value.Items.Add(F_Table.FieldByName('UF').AsString);
    F_Table.Next;
  end;
end;

end.
